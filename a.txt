import pandas as pd
from openpyxl import load_workbook

# Load the existing Excel file with pivot table
excel_file = '/Users/samirsm1mac/Downloads/sam.xlsx'  # Replace with your file path
book = load_workbook(excel_file)

# Create your new DataFrame (example data, replace with your own)
new_data = pd.DataFrame({
    'Column1': [1, 2, 3],
    'Column2': ['A', 'B', 'C']
})

# Create a pandas Excel writer using the loaded workbook
writer = pd.ExcelWriter(excel_file, engine='openpyxl')
writer.book = book

# Write the new DataFrame to a new sheet
new_data.to_excel(writer, sheet_name='New_Sheet', index=False)

# Save the Excel file
writer.save()
